

<!DOCTYPE html>
<html lang="es">
<head>
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-0TJZ3HFG6H"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-0TJZ3HFG6H');
        }
      </script>
    
  

<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="robots" content="index, follow"><link rel="author" href="/humans.txt">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#494f5c">
<meta name="msapplication-TileColor" content="#494f5c">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#494f5c"><style>
  body::before {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/images/back1.jpeg');
    background-size: cover;
    background-position: center;
    z-index: -1;
  }
</style>
<meta name="author" content="Maximiliano Belino"><meta name="description" content="Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link">

  <meta itemprop="name" content="Rogue Access Point (AP)">
  <meta itemprop="description" content="Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link">
  <meta itemprop="datePublished" content="2025-05-09T12:28:27-03:00">
  <meta itemprop="dateModified" content="2025-05-09T12:28:27-03:00">
  <meta itemprop="wordCount" content="1117">
  <meta itemprop="keywords" content="Rogue,AP,Acceso,WiFi,Paquetes,Captura"><meta property="og:url" content="https://belino.com/es/posts/rogueap/">
  <meta property="og:site_name" content="Trusted Cybersecurity">
  <meta property="og:title" content="Rogue Access Point (AP)">
  <meta property="og:description" content="Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-09T12:28:27-03:00">
    <meta property="article:modified_time" content="2025-05-09T12:28:27-03:00">
    <meta property="article:tag" content="Rogue">
    <meta property="article:tag" content="AP">
    <meta property="article:tag" content="Acceso">
    <meta property="article:tag" content="WiFi">
    <meta property="article:tag" content="Paquetes">
    <meta property="article:tag" content="Captura">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Rogue Access Point (AP)">
  <meta name="twitter:description" content="Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link">

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Rogue Access Point (AP)",
    "name": "Rogue Access Point (AP)",
    "description": "Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link",
    "keywords": ["Rogue", "AP", "Acceso", "WiFi", "Paquetes", "Captura"],
    "articleBody": " Dispositivo Driver Instalando desde el repo de GitHub Verificar el PowerManagement del wifi Verificaciones Verificamos mensajes de log en dmesg Verificar los equipos conectados al rogue AP Ejecutando el script Script para levantar el AP Dispositivo TP-Link Archer T3U Plus (chipset RTL88x2BU) en modo Access Point (AP) tipo Rogue\nDriver Para el driver voy a usar esta source en GitHub: https://github.com/lwfinger/rtw88\nEste repo es para drivers Realtek Estar√© usando el driver RTL8822BU Como adelanto, una vez que quede instalado el Driver del dispositivo, vamos a ver estos resultados:\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ readlink /sys/class/net/wlan0/device/driver ../../../../../../../bus/usb/drivers/rtw_8822bu ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ dkms status rtw88/0.6, 6.12.20-amd64, x86_64: installed ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ lsmod | grep rtw rtw_8822bu 12288 0 rtw_usb 32768 1 rtw_8822bu rtw_8822b 233472 1 rtw_8822bu rtw_core 315392 2 rtw_usb,rtw_8822b mac80211 1445888 2 rtw_usb,rtw_core cfg80211 1392640 2 rtw_core,mac80211 usbcore 409600 8 rtw_usb,ehci_pci,usbhid,btmtk,rtw_8822bu,ehci_hcd,btusb,uhci_hcd ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ lsmod | grep rtw rtw_8822bu 12288 0 rtw_usb 32768 1 rtw_8822bu rtw_8822b 233472 1 rtw_8822bu rtw_core 315392 2 rtw_usb,rtw_8822b mac80211 1445888 2 rtw_usb,rtw_core cfg80211 1392640 2 rtw_core,mac80211 usbcore 409600 8 rtw_usb,ehci_pci,usbhid,btmtk,rtw_8822bu,ehci_hcd,btusb,uhci_hcd Instalando desde el repo de GitHub Prerequisitos Actualizar e instalar:\nsudo apt update \u0026\u0026 sudo apt upgrade sudo apt install linux-headers-$(uname -r) build-essential git Seguimos con los pasos recomendados en el GitHub.\nPaso 1: Instalamos dkms\nDKMS (Dynamic Kernel Module Support) permite que el m√≥dulo se recompile autom√°ticamente cada vez que se actualiza el kernel.\nSin dkms, tendr√≠a que recompilar el m√≥dulo manualmente tras cada actualizaci√≥n del kernel.\nInstalamos:\nsudo apt install -y dkms Paso 2: no es necesario en mi caso, se puede omitir pues:\n‚ö†Ô∏è Nota sobre UEFI y Secure Boot: Los pasos 2.1 a 2.4 (generar llave, certificado y registrarlo con mokutil) solo son necesarios si est√°s instalando el driver en un sistema con UEFI + Secure Boot habilitado., una caracter√≠stica de seguridad que impide cargar m√≥dulos del kernel no firmados.\nEsto aplica principalmente a sistemas f√≠sicos modernos con UEFI y Secure Boot habilitado, como laptops o PCs que vienen con Windows preinstalado de f√°brica.\nüñ•Ô∏è En m√°quinas virtuales (VMs), como las que se usan en VMware o VirtualBox, Secure Boot generalmente est√° deshabilitado o no disponible por defecto, por lo que no es necesario realizar estos pasos, normalmente usan arranque BIOS (Legacy) sin Secure Boot.\nPuedes verificar si tu sistema usa UEFI ejecutando:\n[ -d /sys/firmware/efi ] \u0026\u0026 echo \"Modo UEFI\" || echo \"Modo BIOS (Legacy)\" En mi caso estoy en Modo BIOS, por lo que si ejecuto lo que indica el Paso 2.4 ver√©:\n‚îî‚îÄ$ mokutil --list-enrolled EFI variables are not supported on this system Paso 3 al 7: Clonamos el repo en /usr/src y agregamos e instalamos el rtw88 al dkms\ncd /usr/src \u0026\u0026 sudo git clone [https://github.com/lwfinger/rtw88.git](https://github.com/lwfinger/rtw88.git) rtw88-0.6 sudo dkms add -m rtw88 -v 0.6 sudo dkms build -m rtw88 -v 0.6 sudo dkms install -m rtw88 -v 0.6 dkms status Verificar el PowerManagement del wifi Previo: asegurarnos de que hemos conectado el dispositivo TP-link USB y que est√° disponible (conectado) a la Virtual Machine.\nAntes, por las dudas, verificar que el screensaver no haga el bloqueo de la pantalla:\nEsto es por recomendaci√≥n, a mi me daba problemas cuando se bloqueaba.\nEn cuanto al PowerManagement del dispositivo Wifi USB:\nSi el \"power save\" est√° en On lo pondremos en Off La siguiente configuraci√≥n no va a funcionar, y debajo dejo el por qu√©:\nsudo nano /etc/NetworkManager/conf.d/default-wifi-powersave-on.conf Contenido del archivo\n[connection] wifi.powersave = 2 Lo verificamos desde consola:\n‚îî‚îÄ$ iw dev wlan0 get power_save Power save: on ‚ÄúEl archivo /etc/NetworkManager/conf.d/default-wifi-powersave-on.conf solo afecta conexiones gestionadas por NetworkManager (como perfiles de red que levant√°s con nmcli o la interfaz gr√°fica). Pero si est√°s montando un Rogue AP o usando hostapd, airbase-ng, o iw directamente, no pasa por NetworkManager, y entonces ese ajuste no tiene efecto.‚Äù\nEste s√≠ hace efecto:\niw dev wlan0 set power_save off Esto funciona de inmediato porque est√°s hablando directamente con el kernel y la interfaz; pero es temporal: se resetea al reiniciar o reiniciar la interfaz, por lo que lo voy a poner en el script que tengo que levanta lo necesario para el Rogue AP.\nEditamos entonces el script del Rogue AP\nsudo nano rogue_hostapd3.sh Agregamos estas lineas:\n# Desactivar el PowerManagement / Disable WiFi Power Save iw dev wlan0 set power_save off En un .conf tambi√©n seteamos que el NetworkManager no ‚Äútoque‚Äù este dispositivo wlan0\nsudo nano /etc/NetworkManager/conf.d/unmanaged.conf Contenido del archivo:\n[keyfile] unmanaged-devices=interface-name:wlan0 Verificaciones Estas son verificaciones que podemos hacer cuando el AP est√° en funcionamiento.\nVerificamos mensajes de log en dmesg Ejecutamos en una terminal:\ndmesg -w Verificar los equipos conectados al rogue AP Ejecutamos en una terminal:\niw dev wlan0 station dump Ejecutando el script Ejecutamos el script (que ya le d√≠ previamente los permisos de ejecuci√≥n con chmod)\n‚îî‚îÄ$ sudo ./rogue_hostapd3.sh [*] Cerrando instancia previa de dnsmasq si existe... [*] Activando IP forwarding... [*] Configurando wlan0 con IP 192.168.69.1... [*] Limpiando reglas iptables previas... [*] Configurando iptables para NAT... [*] Generando configuraci√≥n de hostapd... [*] Generando configuraci√≥n de dnsmasq... [*] Iniciando dnsmasq... [*] Iniciando hostapd... wlan0: interface state UNINITIALIZED-\u003eENABLED wlan0: AP-ENABLED y al conectarse el m√≥vil vemos algo as√≠:\nwlan0: STA 4a:d6:01:b5:f2:ff IEEE 802.11: authenticated wlan0: STA 4a:d6:01:b5:f2:ff IEEE 802.11: associated (aid 1) wlan0: AP-STA-CONNECTED 4a:d6:01:b5:f2:ff wlan0: STA 4a:d6:01:b5:f2:ff RADIUS: starting accounting session A10F5F2FFA3CB549 Script para levantar el AP #!/bin/bash # Rogue AP. Version 3 # Author: Maximiliano Belino (m4xth0r) # Author website: https://belino.com # Date: 11 de Abril 2025 # Variables IFACE=\"wlan0\" ESSID=\"superv4\" CHANNEL=6 NETPREFIX=\"192.168.69\" GATEWAY=\"$NETPREFIX.1\" RANGE_START=\"$NETPREFIX.2\" RANGE_END=\"$NETPREFIX.30\" NETMASK=\"255.255.255.0\" CONF_DIR=\"/tmp/rogue_ap\" mkdir -p \"$CONF_DIR\" # Desactivar el PowerManagement # Disable WiFi Power Save iw dev wlan0 set power_save off # Matamos dnsmasq solo si ya corre (evitamos matar la shell) echo \"[*] Cerrando instancia previa de dnsmasq si existe...\" pgrep dnsmasq \u0026\u0026 sudo killall dnsmasq # Activamos IP forwarding echo \"[*] Activando IP forwarding...\" echo 1 \u003e /proc/sys/net/ipv4/ip_forward # Configurar interfaz echo \"[*] Configurando $IFACE con IP $GATEWAY...\" ip addr flush dev \"$IFACE\" ip link set \"$IFACE\" up ip addr add \"$GATEWAY/24\" dev \"$IFACE\" # Limpiamos reglas iptables previas echo \"[*] Limpiando reglas iptables previas...\" iptables --flush iptables --table nat --flush iptables --delete-chain iptables --table nat --delete-chain # Configurar NAT echo \"[*] Configurando iptables para NAT...\" iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE iptables -A FORWARD -i eth0 -o \"$IFACE\" -m state --state RELATED,ESTABLISHED -j ACCEPT iptables -A FORWARD -i \"$IFACE\" -o eth0 -j ACCEPT # Archivo hostapd.conf echo \"[*] Generando configuraci√≥n de hostapd...\" cat \u003c \"$CONF_DIR/hostapd.conf\" interface=$IFACE driver=nl80211 ssid=$ESSID hw_mode=g channel=$CHANNEL auth_algs=1 ignore_broadcast_ssid=0 EOF # Archivo dnsmasq.conf echo \"[*] Generando configuraci√≥n de dnsmasq...\" cat \u003c \"$CONF_DIR/dnsmasq.conf\" interface=$IFACE dhcp-range=$RANGE_START,$RANGE_END,12h dhcp-option=3,$GATEWAY dhcp-option=6,$GATEWAY log-queries log-dhcp EOF # Iniciamos dnsmasq (en background) echo \"[*] Iniciando dnsmasq...\" dnsmasq -C \"$CONF_DIR/dnsmasq.conf\" \u0026 # Iniciamos hostapd echo \"[*] Iniciando hostapd...\" hostapd \"$CONF_DIR/hostapd.conf\" echo \"[+] Rogue AP '$ESSID' operativo.\" ",
    "wordCount" : "1117",
    "inLanguage": "es",
    "datePublished": "2025-05-09T12:28:27-03:00",
    "dateModified": "2025-05-09T12:28:27-03:00",
    "author":{
        "@type": "Person",
        "name": "Maximiliano Belino",
        "url": "https://belino.com/es/about/"
        },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://belino.com/es/posts/rogueap/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Trusted Cybersecurity",
      "description": "Cybersecurity expert,Cloud, AD, VMs",
      "logo": {
        "@type": "ImageObject",
        "url": "https://belino.com/favicon.ico"
      }
    }
}
</script><title>Rogue Access Point (AP)</title>
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet dns-prefetch preconnect preload prefetch" as="style" href="https://belino.com/css/style.min.25c88b6154c306fe460b1ed752089bbd1b40ee9caceb5739c309a147f9b647f4.css" integrity="sha256-JciLYVTDBv5GCx7XUgibvRtA7pys61c5wwmhR/m2R/Q=" crossorigin="anonymous">
	<nav class="LangNav" style="text-align:right;">
	
		<a href="https://belino.com/en/posts/rogueap/">English</a>
		
		 üá∫üá∏ 
	
	</nav></head>
<body id="page">
	<header id="site-header">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left" style="font-size: 14px;">
				<div class="site-branding">
					<a href="/es/">Trusted Cybersecurity</a>
				</div>
				<nav class="site-nav hide-in-mobile"><a href="https://belino.com/es/services/">Servicios</a><a href="https://belino.com/es/research/">Investigaci√≥n</a><a href="https://belino.com/es/posts/">Publicaciones</a><a href="https://belino.com/es/about/">Acerca</a></nav>
			</div>
			<div class="hdr-right hdr-icons" style="font-size: 18px;">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list">
      <line x1="8" y1="6" x2="21" y2="6"></line>
      <line x1="8" y1="12" x2="21" y2="12"></line>
      <line x1="8" y1="18" x2="21" y2="18"></line>
      <line x1="3" y1="6" x2="3" y2="6"></line>
      <line x1="3" y1="12" x2="3" y2="12"></line>
      <line x1="3" y1="18" x2="3" y2="18"></line>
   </svg></button><span class="hdr-links hide-in-mobile"><a href="mailto:max.cybersecurity@belino.com" target="_blank" rel="noopener me" title="Mail"><svg xmlns="http://www.w3.org/2000/svg" class="feather feather-link" width="24" height="24" viewBox="0 0 24 24"
      fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
   </svg></a><a href="https://www.linkedin.com/in/maximiliano-belino" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
   <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
   <rect x="2" y="9" width="4" height="12"></rect>
   <circle cx="4" cy="4" r="2"></circle>
</svg></a><a href="https://discordapp.com/users/470354265962184714" target="_blank" rel="noopener me" title="Discord"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke-linecap="round" stroke-linejoin="round">
   <path
      d="M8.82889 11.203C7.86239 11.203 7.09937 12.0508 7.09937 13.0852C7.09937 14.1195 7.87935 14.9673 8.82889 14.9673C9.79538 14.9673 10.5584 14.1195 10.5584 13.0852C10.5754 12.0508 9.79538 11.203 8.82889 11.203ZM15.0178 11.203C14.0514 11.203 13.2883 12.0508 13.2883 13.0852C13.2883 14.1195 14.0683 14.9673 15.0178 14.9673C15.9843 14.9673 16.7474 14.1195 16.7474 13.0852C16.7474 12.0508 15.9843 11.203 15.0178 11.203Z"
      fill="currentColor" />
   <path
      d="M14.8477 18.3649C14.8874 18.4483 14.9381 18.5296 15.0005 18.6075C15.3663 19.0644 15.7387 19.5135 15.8832 19.687C16.1242 19.9764 16.4855 20.1329 16.8553 20.117C20.6839 19.9522 22.4053 17.6063 22.7126 17.1342C22.8526 16.919 22.9029 16.6887 22.9023 16.4867C22.8862 11.0873 20.6126 6.69288 20.3618 6.22299C20.2686 6.04849 20.1448 5.9213 20.0223 5.83024C17.6324 4.05442 15.3398 3.89258 14.7987 3.87945C14.4248 3.87037 14.1018 4.039 13.8908 4.28019C13.7833 4.40298 13.7069 4.53817 13.659 4.67843C12.4808 4.5498 11.3488 4.5684 10.3271 4.681C10.2848 4.54257 10.2137 4.40813 10.1111 4.28494C9.90289 4.03513 9.58304 3.87239 9.22517 3.87894C8.72884 3.88801 6.40341 4.02781 3.9777 5.83024C3.85516 5.9213 3.73139 6.04849 3.63825 6.22299C3.38742 6.69289 1.11365 11.0876 1.09774 16.4873C1.09715 16.6871 1.14634 16.9155 1.28416 17.1296C1.58866 17.6027 3.29601 19.9515 7.12649 20.1169C7.50079 20.1331 7.86486 19.9726 8.10512 19.6794C8.2521 19.5 8.63516 19.0311 9.00416 18.5683C9.06865 18.4874 9.12057 18.4028 9.16075 18.316C9.32759 18.3546 9.49869 18.391 9.67405 18.4248L9.67405 18.4248L9.68004 18.426C11.0465 18.681 12.6626 18.7747 14.4312 18.4443C14.5698 18.4206 14.7086 18.3942 14.8477 18.3649Z"
      stroke="currentColor" stroke-width="2" />
</svg></a></span><button id="share-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2">
      <circle cx="18" cy="5" r="3"></circle>
      <circle cx="6" cy="12" r="3"></circle>
      <circle cx="18" cy="19" r="3"></circle>
      <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
      <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
   </svg></button>
 
<div id="share-links" class="animated fast">
    
    
    
    
    <ul>
        <li>
            <a href="https://twitter.com/intent/tweet?hashtags=hermit2&amp;url=https%3a%2f%2fbelino.com%2fes%2fposts%2frogueap%2f&amp;text=Rogue%20Access%20Point%20%28AP%29" target="_blank" rel="noopener" aria-label="Share on X"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
   <path class="st0" d="m21.3 21.1 -11.4 -18.2h-7.2l11.4 18.2zm-18.6 0 7.2 -6.6m4.2 -5 7.2 -6.6" />
</svg></a>
        </li>
        <li>
            <a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbelino.com%2fes%2fposts%2frogueap%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
   <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg></a>
        </li>
        <li>
            <a href="mailto:?subject=Rogue%20Access%20Point%20%28AP%29&amp;body=https%3a%2f%2fbelino.com%2fes%2fposts%2frogueap%2f" target="_self" rel="noopener" aria-label="Share on Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
   <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
   <polyline points="22,6 12,13 2,6"></polyline>
</svg></a>
        </li>
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fbelino.com%2fes%2fposts%2frogueap%2f&amp;source=https%3a%2f%2fbelino.com%2f&amp;title=Rogue%20Access%20Point%20%28AP%29&amp;summary=Rogue%20Access%20Point%20%28AP%29%2c%20by%20Maximiliano%20Belino%0a%0aPunto%20de%20Acceso%20Wifi%20%28Rogue%20AP%29%20usando%20una%20antena%20WiFi%20TP-Link%0a" target="_blank" rel="noopener" aria-label="Share on LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none"
   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
   <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
   <rect x="2" y="9" width="4" height="12"></rect>
   <circle cx="4" cy="4" r="2"></circle>
</svg></a>
        </li>
        <li>
            <a href="#" onclick="linkShare(&#34;Rogue Access Point (AP)&#34;,&#34;https://belino.com/es/posts/rogueap/&#34;,&#34;Rogue Access Point (AP), by Maximiliano Belino\n\nPunto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link\n&#34;); return false;" target="_self" rel="noopener" aria-label="Copy Link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
   </svg></a>
        </li>
    </ul>
</div><button id="menu-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
   </svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://belino.com/es/services/">Servicios</a></li>
			<li><a href="https://belino.com/es/research/">Investigaci√≥n</a></li>
			<li><a href="https://belino.com/es/posts/">Publicaciones</a></li>
			<li><a href="https://belino.com/es/about/">Acerca</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster"><article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>May 9, 2025</span></div>
				<h1>Rogue Access Point (AP)</h1>
			</header>
			<div class="post-info"><p>Punto de Acceso Wifi (Rogue AP) usando una antena WiFi TP-Link</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
   stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather">
   <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path>
   <line x1="16" y1="8" x2="2" y2="22"></line>
   <line x1="17.5" y1="15" x2="9" y2="15"></line>
</svg><a href="/es/about/" target="_blank">Maximiliano Belino</a></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon">
      <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
      <line x1="7" y1="7" x2="7" y2="7"></line>
   </svg><span class="tag"><a href="https://belino.com/es/tags/rogue">Rogue</a></span><span class="tag"><a href="https://belino.com/es/tags/ap">AP</a></span><span class="tag"><a href="https://belino.com/es/tags/acceso">Acceso</a></span><span class="tag"><a href="https://belino.com/es/tags/wifi">WiFi</a></span><span class="tag"><a href="https://belino.com/es/tags/paquetes">Paquetes</a></span><span class="tag"><a href="https://belino.com/es/tags/captura">Captura</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
      <polyline points="14 2 14 8 20 8"></polyline>
      <line x1="16" y1="13" x2="8" y2="13"></line>
      <line x1="16" y1="17" x2="8" y2="17"></line>
      <polyline points="10 9 9 9 8 9"></polyline>
   </svg>1117 
    ‚Ä¶ ‚è≤ Reading Time:
    
    
    
    5 Minutes, 4 Seconds</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
      <line x1="16" y1="2" x2="16" y2="6"></line>
      <line x1="8" y1="2" x2="8" y2="6"></line>
      <line x1="3" y1="10" x2="21" y2="10"></line>
   </svg>2025-05-09 12:28 -0300</p></div>
			<hr class="post-end">
			<div class="content">
				<ul>
<li><a href="/es/posts/rogueap/#dispositivo">Dispositivo</a></li>
<li><a href="/es/posts/rogueap/#driver">Driver</a>
<ul>
<li><a href="/es/posts/rogueap/#instalando-desde-el-repo-de-github">Instalando desde el repo de GitHub</a></li>
</ul>
</li>
<li><a href="/es/posts/rogueap/#verificar-el-powermanagement-del-wifi">Verificar el PowerManagement del wifi</a></li>
<li><a href="/es/posts/rogueap/#verificaciones">Verificaciones</a>
<ul>
<li><a href="/es/posts/rogueap/#verificamos-mensajes-de-log-en-dmesg">Verificamos mensajes de log en dmesg</a></li>
<li><a href="/es/posts/rogueap/#verificar-los-equipos-conectados-al-rogue-ap">Verificar los equipos conectados al rogue AP</a></li>
</ul>
</li>
<li><a href="/es/posts/rogueap/#ejecutando-el-script">Ejecutando el script</a></li>
<li><a href="/es/posts/rogueap/#script-para-levantar-el-ap">Script para levantar el AP</a></li>
</ul>
<h1 id="dispositivo">Dispositivo<a href="#dispositivo" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>TP-Link Archer T3U Plus (chipset RTL88x2BU) en modo Access Point (AP) tipo Rogue</p>
<h1 id="driver">Driver<a href="#driver" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>Para el driver voy a usar esta source en GitHub: <a href="https://github.com/lwfinger/rtw88">https://github.com/lwfinger/rtw88</a></p>
<ul>
<li>Este repo es para drivers Realtek</li>
<li>Estar√© usando el driver RTL8822BU</li>
</ul>
<p>Como adelanto, una vez que quede instalado el Driver del dispositivo, vamos a ver estos resultados:</p>
<pre tabindex="0"><code>‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ readlink /sys/class/net/wlan0/device/driver
../../../../../../../bus/usb/drivers/rtw_8822bu

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ dkms status
rtw88/0.6, 6.12.20-amd64, x86_64: installed

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ lsmod | grep rtw
rtw_8822bu             12288  0
rtw_usb                32768  1 rtw_8822bu
rtw_8822b             233472  1 rtw_8822bu
rtw_core              315392  2 rtw_usb,rtw_8822b
mac80211             1445888  2 rtw_usb,rtw_core
cfg80211             1392640  2 rtw_core,mac80211
usbcore               409600  8 rtw_usb,ehci_pci,usbhid,btmtk,rtw_8822bu,ehci_hcd,btusb,uhci_hcd

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ lsmod | grep rtw
rtw_8822bu 12288 0
rtw_usb 32768 1 rtw_8822bu
rtw_8822b 233472 1 rtw_8822bu
rtw_core 315392 2 rtw_usb,rtw_8822b
mac80211 1445888 2 rtw_usb,rtw_core
cfg80211 1392640 2 rtw_core,mac80211
usbcore 409600 8 rtw_usb,ehci_pci,usbhid,btmtk,rtw_8822bu,ehci_hcd,btusb,uhci_hcd
</code></pre><h2 id="instalando-desde-el-repo-de-github">Instalando desde el repo de GitHub<a href="#instalando-desde-el-repo-de-github" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="prerequisitos">Prerequisitos<a href="#prerequisitos" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Actualizar e instalar:</p>
<pre tabindex="0"><code>sudo apt update &amp;&amp; sudo apt upgrade
sudo apt install linux-headers-$(uname -r) build-essential git
</code></pre><p>Seguimos con los pasos recomendados en el GitHub.</p>
<p>Paso 1: Instalamos <strong>dkms</strong></p>
<ul>
<li>
<p><strong>DKMS (Dynamic Kernel Module Support)</strong> permite que el m√≥dulo se <strong>recompile autom√°ticamente</strong> cada vez que se actualiza el kernel.</p>
</li>
<li>
<p>Sin <code>dkms</code>, tendr√≠a que recompilar el m√≥dulo <strong>manualmente</strong> tras cada actualizaci√≥n del kernel.</p>
</li>
</ul>
<p>Instalamos:</p>
<pre tabindex="0"><code>sudo apt install -y dkms
</code></pre><p>Paso 2: no es necesario en mi caso, se puede omitir pues:</p>
<p>‚ö†Ô∏è <strong>Nota sobre UEFI y Secure Boot:</strong>
Los pasos 2.1 a 2.4 (generar llave, certificado y registrarlo con <code>mokutil</code>) <strong>solo son necesarios si est√°s instalando el driver en un sistema con UEFI + Secure Boot habilitado</strong>., una caracter√≠stica de seguridad que <strong>impide cargar m√≥dulos del kernel no firmados</strong>.</p>
<p>Esto aplica principalmente a <strong>sistemas f√≠sicos modernos</strong> con <strong>UEFI y Secure Boot habilitado</strong>, como laptops o PCs que vienen con <strong>Windows preinstalado de f√°brica</strong>.</p>
<p>üñ•Ô∏è <strong>En m√°quinas virtuales (VMs)</strong>, como las que se usan en <strong>VMware o VirtualBox</strong>, <strong>Secure Boot generalmente est√° deshabilitado o no disponible por defecto</strong>, por lo que <strong>no es necesario realizar estos pasos</strong>, normalmente usan arranque BIOS (Legacy) sin Secure Boot.<br>
Puedes verificar si tu sistema usa UEFI ejecutando:</p>
<pre tabindex="0"><code>[ -d /sys/firmware/efi ] &amp;&amp; echo &#34;Modo UEFI&#34; || echo &#34;Modo BIOS (Legacy)&#34;
</code></pre><p>En mi caso estoy en Modo BIOS, por lo que si ejecuto lo que indica el Paso 2.4 ver√©:</p>
<pre tabindex="0"><code>‚îî‚îÄ$ mokutil --list-enrolled
EFI variables are not supported on this system
</code></pre><p>Paso 3 al 7: Clonamos el repo en /usr/src y agregamos e instalamos el rtw88 al dkms</p>
<pre tabindex="0"><code>cd /usr/src &amp;&amp; sudo git clone [https://github.com/lwfinger/rtw88.git](https://github.com/lwfinger/rtw88.git) rtw88-0.6
sudo dkms add -m rtw88 -v 0.6
sudo dkms build -m rtw88 -v 0.6
sudo dkms install -m rtw88 -v 0.6
dkms status
</code></pre><h1 id="verificar-el-powermanagement-del-wifi">Verificar el PowerManagement del wifi<a href="#verificar-el-powermanagement-del-wifi" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>Previo: asegurarnos de que hemos conectado el dispositivo TP-link USB y que est√° disponible (conectado) a la Virtual Machine.</p>
<p>Antes, por las dudas, verificar que el screensaver <strong>no haga</strong> el bloqueo de la pantalla:</p>
<p><img src="../../../images/Rogue%20AP.png"></p>
<p>Esto es por recomendaci√≥n, a mi me daba problemas cuando se bloqueaba.</p>
<p>En cuanto al <strong>PowerManagement</strong> del dispositivo Wifi USB:</p>
<pre><code>Si el &quot;power save&quot; est√° en On lo pondremos en Off
</code></pre>
<p>La siguiente configuraci√≥n no va a funcionar, y debajo dejo el por qu√©:</p>
<pre tabindex="0"><code>sudo nano /etc/NetworkManager/conf.d/default-wifi-powersave-on.conf
</code></pre><p>Contenido del archivo</p>
<pre tabindex="0"><code>[connection]
wifi.powersave = 2
</code></pre><p>Lo verificamos desde consola:</p>
<pre tabindex="0"><code>‚îî‚îÄ$ iw dev wlan0 get power_save
Power save: on
</code></pre><p>&ldquo;El archivo <code>/etc/NetworkManager/conf.d/default-wifi-powersave-on.conf</code> <strong>solo afecta conexiones gestionadas por NetworkManager</strong> (como perfiles de red que levant√°s con <code>nmcli</code> o la interfaz gr√°fica). Pero si est√°s montando un <strong>Rogue AP</strong> o usando <code>hostapd</code>, <code>airbase-ng</code>, o <code>iw</code> directamente, <strong>no pasa por NetworkManager</strong>, y entonces ese ajuste no tiene efecto.&rdquo;</p>
<p>Este s√≠ hace efecto:</p>
<pre tabindex="0"><code>iw dev wlan0 set power_save off
</code></pre><p>Esto funciona de inmediato porque est√°s hablando directamente con el kernel y la interfaz; pero es temporal: se resetea al reiniciar o reiniciar la interfaz, por lo que lo voy a poner en el script que tengo que levanta lo necesario para el Rogue AP.</p>
<p>Editamos entonces el script del Rogue AP</p>
<pre tabindex="0"><code>sudo nano rogue_hostapd3.sh
</code></pre><p>Agregamos estas lineas:</p>
<pre tabindex="0"><code># Desactivar el PowerManagement / Disable WiFi Power Save
iw dev wlan0 set power_save off
</code></pre><p>En un .conf tambi√©n seteamos que el NetworkManager no &ldquo;toque&rdquo; este dispositivo wlan0</p>
<pre tabindex="0"><code>sudo nano /etc/NetworkManager/conf.d/unmanaged.conf
</code></pre><p>Contenido del archivo:</p>
<pre tabindex="0"><code>[keyfile]
unmanaged-devices=interface-name:wlan0
</code></pre><h1 id="verificaciones">Verificaciones<a href="#verificaciones" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>Estas son verificaciones que podemos hacer cuando el AP est√° en funcionamiento.</p>
<h2 id="verificamos-mensajes-de-log-en-dmesg">Verificamos mensajes de log en dmesg<a href="#verificamos-mensajes-de-log-en-dmesg" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Ejecutamos en una terminal:</p>
<pre tabindex="0"><code>dmesg -w
</code></pre><h2 id="verificar-los-equipos-conectados-al-rogue-ap">Verificar los equipos conectados al rogue AP<a href="#verificar-los-equipos-conectados-al-rogue-ap" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Ejecutamos en una terminal:</p>
<pre tabindex="0"><code>iw dev wlan0 station dump
</code></pre><h1 id="ejecutando-el-script">Ejecutando el script<a href="#ejecutando-el-script" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>Ejecutamos el script (que ya le d√≠ previamente los permisos de ejecuci√≥n con <em>chmod</em>)</p>
<pre tabindex="0"><code>‚îî‚îÄ$ sudo ./rogue_hostapd3.sh
[*] Cerrando instancia previa de dnsmasq si existe...
[*] Activando IP forwarding...
[*] Configurando wlan0 con IP 192.168.69.1...
[*] Limpiando reglas iptables previas...
[*] Configurando iptables para NAT...
[*] Generando configuraci√≥n de hostapd...
[*] Generando configuraci√≥n de dnsmasq...
[*] Iniciando dnsmasq...
[*] Iniciando hostapd...
wlan0: interface state UNINITIALIZED-&gt;ENABLED
wlan0: AP-ENABLED
</code></pre><p>y al conectarse el m√≥vil vemos algo as√≠:</p>
<pre tabindex="0"><code>wlan0: STA 4a:d6:01:b5:f2:ff IEEE 802.11: authenticated
wlan0: STA 4a:d6:01:b5:f2:ff IEEE 802.11: associated (aid 1)
wlan0: AP-STA-CONNECTED 4a:d6:01:b5:f2:ff
wlan0: STA 4a:d6:01:b5:f2:ff RADIUS: starting accounting session A10F5F2FFA3CB549
</code></pre><h1 id="script-para-levantar-el-ap">Script para levantar el AP<a href="#script-para-levantar-el-ap" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<pre tabindex="0"><code>#!/bin/bash

# Rogue AP. Version 3
# Author: Maximiliano Belino (m4xth0r)
# Author website: https://belino.com
# Date: 11 de Abril 2025

# Variables
IFACE=&#34;wlan0&#34;
ESSID=&#34;superv4&#34;
CHANNEL=6
NETPREFIX=&#34;192.168.69&#34;
GATEWAY=&#34;$NETPREFIX.1&#34;
RANGE_START=&#34;$NETPREFIX.2&#34;
RANGE_END=&#34;$NETPREFIX.30&#34;
NETMASK=&#34;255.255.255.0&#34;
CONF_DIR=&#34;/tmp/rogue_ap&#34;
mkdir -p &#34;$CONF_DIR&#34;

# Desactivar el PowerManagement
# Disable WiFi Power Save
iw dev wlan0 set power_save off

# Matamos dnsmasq solo si ya corre (evitamos matar la shell)
echo &#34;[*] Cerrando instancia previa de dnsmasq si existe...&#34;
pgrep dnsmasq &amp;&amp; sudo killall dnsmasq

# Activamos IP forwarding
echo &#34;[*] Activando IP forwarding...&#34;
echo 1 &gt; /proc/sys/net/ipv4/ip_forward

# Configurar interfaz
echo &#34;[*] Configurando $IFACE con IP $GATEWAY...&#34;
ip addr flush dev &#34;$IFACE&#34;
ip link set &#34;$IFACE&#34; up
ip addr add &#34;$GATEWAY/24&#34; dev &#34;$IFACE&#34;

# Limpiamos reglas iptables previas
echo &#34;[*] Limpiando reglas iptables previas...&#34;
iptables --flush
iptables --table nat --flush
iptables --delete-chain
iptables --table nat --delete-chain

# Configurar NAT
echo &#34;[*] Configurando iptables para NAT...&#34;
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
iptables -A FORWARD -i eth0 -o &#34;$IFACE&#34; -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i &#34;$IFACE&#34; -o eth0 -j ACCEPT

# Archivo hostapd.conf
echo &#34;[*] Generando configuraci√≥n de hostapd...&#34;
cat &lt;&lt;EOF &gt; &#34;$CONF_DIR/hostapd.conf&#34;
interface=$IFACE
driver=nl80211
ssid=$ESSID
hw_mode=g
channel=$CHANNEL
auth_algs=1
ignore_broadcast_ssid=0
EOF

# Archivo dnsmasq.conf
echo &#34;[*] Generando configuraci√≥n de dnsmasq...&#34;
cat &lt;&lt;EOF &gt; &#34;$CONF_DIR/dnsmasq.conf&#34;
interface=$IFACE
dhcp-range=$RANGE_START,$RANGE_END,12h
dhcp-option=3,$GATEWAY
dhcp-option=6,$GATEWAY
log-queries
log-dhcp
EOF

# Iniciamos dnsmasq (en background)
echo &#34;[*] Iniciando dnsmasq...&#34;
dnsmasq -C &#34;$CONF_DIR/dnsmasq.conf&#34; &amp;

# Iniciamos hostapd
echo &#34;[*] Iniciando hostapd...&#34;
hostapd &#34;$CONF_DIR/hostapd.conf&#34;

echo &#34;[+] Rogue AP &#39;$ESSID&#39; operativo.&#34;
</code></pre>
			</div>
			<div class="human posts"><a href="https://brainmade.org/" target="_blank" rel="external noreferrer noopener"><abbr title=""><svg fill="#fff" width="128" height="40" viewBox="0 0 128 40" xmlns="http://www.w3.org/2000/svg">
      <path
         d="M26.306 39.391H11.665a1.28 1.28 0 0 1-1.28-1.28v-3.838H6.399a1.28 1.28 0 0 1-1.28-1.28v-5.336l-4.41-2.198a1.28 1.28 0 0 1-.493-1.855l4.904-7.357v-2.175C5.12 6.298 11.422 0 19.194 0s14.073 6.3 14.075 14.071c-.316 13.912-5.38 11.758-5.59 17.023l-.093 7.018a1.3 1.3 0 0 1-.375.905 1.27 1.27 0 0 1-.905.375zm-13.361-2.559h12.082l.143-7.27c-.132-3.329 5.858-4.122 5.54-15.368-.179-6.356-5.157-11.635-11.515-11.635S7.68 7.713 7.679 14.071v2.559c-.001.253-.075.5-.215.71l-4.315 6.471 3.822 1.91a1.28 1.28 0 0 1 .708 1.145v4.848h3.987a1.28 1.28 0 0 1 1.28 1.28z" />
      <path
         d="M20.186 29.111v-9.644c.059 0 .118.009.177.009 4.885-.006 8.525-4.506 7.511-9.284a1.19 1.19 0 0 0-.911-.911 7.67 7.67 0 0 0-9.049 5.67l-.033-.036a7.66 7.66 0 0 0-7.03-2.085 1.19 1.19 0 0 0-.911.91c-1.014 4.777 2.627 9.277 7.51 9.284.118 0 .246-.014.369-.02v6.106zm1.419-16.072a5.33 5.33 0 0 1 4.062-1.553 5.33 5.33 0 0 1-5.614 5.615 5.3 5.3 0 0 1 1.552-4.061zm-7.904 6.057a5.3 5.3 0 0 1-1.559-4.061 5.323 5.323 0 0 1 5.614 5.615 5.3 5.3 0 0 1-4.055-1.554m38.419-6.79q0 2.346-1.567 3.63-1.567 1.282-4.351 1.283h-7.669V0h7.016q2.807 0 4.242 1.1 1.446 1.087 1.446 3.226 0 1.467-.729 2.481-.718 1.002-2.197 1.357 1.86.244 2.828 1.32.979 1.063.979 2.823zm-4.112-7.491q0-1.161-.663-1.65-.652-.488-1.947-.488h-3.655v4.265h3.677q1.36 0 1.968-.525.62-.537.62-1.601m.892 7.209q0-2.42-3.089-2.42h-4.069v4.938h4.188q1.545 0 2.252-.624.718-.635.718-1.894m16.26 5.194-3.557-6.538h-3.764v6.538H54.63V0h7.658q2.741 0 4.231 1.332 1.49 1.32 1.49 3.8 0 1.808-.913 3.128-.914 1.308-2.47 1.723l4.144 7.235zm-.381-11.94q0-2.481-2.828-2.481h-4.112v5.083h4.199q1.349 0 2.045-.684.696-.685.696-1.919m16.785 11.94-1.36-4.399h-5.841l-1.359 4.399h-3.209L75.386 0h3.785l5.569 17.219zM77.278 2.651l-.066.269q-.109.44-.261 1.002c-.152.563-.725 2.436-1.871 6.184h4.405l-1.512-4.949-.468-1.662zm9.551 14.567V0h3.209v17.219zm15.53 0L95.681 3.959q.196 1.931.196 3.104v10.155h-2.849V0h3.666l6.777 13.37q-.196-1.846-.196-3.361V0h2.85v17.219zM52.63 39.375V28.331q.011-.351.115-3.015-.818 3.257-1.209 4.541l-2.925 9.518h-2.418l-2.925-9.518-1.232-4.541q.139 2.809.139 3.717v10.342h-3.017V22.313h4.548l2.902 9.543.253.92.553 2.289.725-2.736 2.983-10.015h4.526v17.063zm17.64 0-1.44-4.359h-6.184l-1.44 4.359h-3.397l5.919-17.063h4.007l5.896 17.063zm-4.537-14.434-.069.267q-.115.436-.277.993c-.162.557-.767 2.414-1.98 6.128h4.663l-1.601-4.905-.495-1.647zm24.577 5.776q0 2.64-.99 4.614-.979 1.961-2.787 3.003-1.796 1.042-4.122 1.042h-6.564V22.313h5.873q4.099 0 6.345 2.18 2.245 2.167 2.245 6.224m-3.42 0q0-2.748-1.359-4.19-1.359-1.453-3.881-1.453h-2.407v11.54h2.879q2.188 0 3.478-1.586t1.29-4.311m6 8.659V22.313h12.759v2.761h-9.362v4.287h8.66v2.761h-8.66v4.492h9.835v2.761zm15.75 0v-3.693h3.328v3.693zm12.445-12.149q2.082 0 3.662.781 1.58.78 2.422 2.235.833 1.454.833 3.393 0 2.98-1.845 4.676Q124.302 40 121.085 40q-3.208 0-5.005-1.688-1.798-1.688-1.798-4.695c0-3.007.606-3.57 1.817-4.694q1.817-1.696 4.986-1.696m0 2.702q-2.157 0-3.378.97-1.23.97-1.23 2.72 0 1.777 1.22 2.747 1.211.97 3.388.97 2.195 0 3.462-.988 1.258-.997 1.258-2.711 0-1.778-1.23-2.738-1.23-.97-3.491-.97m6.725-13.402-5.062 2.935v3.107h5.062v2.648h-13.331v-6.322q0-2.261 1.031-3.491 1.022-1.23 2.942-1.23 1.4 0 2.422.754 1.012.754 1.334 2.038l5.601-3.42zm-9.244.314q-1.92 0-1.921 2.334v3.393h3.936v-3.465q0-1.113-.53-1.688t-1.486-.575m7.249-10.915a6.5 6.5 0 0 0-.313-2.002q-.321-.969-.814-1.499h-1.845v3.088h-2.063V0h4.901q1.088 1.005 1.703 2.622a9.4 9.4 0 0 1 .615 3.375q0 3.088-1.798 4.748-1.808 1.661-5.119 1.661-3.292 0-5.043-1.67-1.76-1.67-1.76-4.803 0-4.452 3.473-5.664l.776 2.442q-1.012.395-1.533 1.238-.52.844-.52 1.984 0 1.867 1.192 2.837t3.416.97q2.261 0 3.501-.997 1.23-1.005 1.23-2.818z" />
   </svg></abbr></a></div>

		</article>
		<aside id="toc">
			<div class="toc-title"></div>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#instalando-desde-el-repo-de-github">Instalando desde el repo de GitHub</a>
      <ul>
        <li><a href="#prerequisitos">Prerequisitos</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#verificamos-mensajes-de-log-en-dmesg">Verificamos mensajes de log en dmesg</a></li>
    <li><a href="#verificar-los-equipos-conectados-al-rogue-ap">Verificar los equipos conectados al rogue AP</a></li>
  </ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="prev-post" href="https://belino.com/es/posts/phplfitorce/">
				<span class="post-nav-label">&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right">
      <line x1="5" y1="12" x2="19" y2="12"></line>
      <polyline points="12 5 19 12 12 19"></polyline>
   </svg></span><br><span>Vulnerabilidad en PHP hasta 7.3. LFI to RCE</span>
			</a>
		</div>
		<div id="comments" class="thin"></div>
	</main>

<footer id="site-footer" class="section-inner thin animated fadeIn faster">
	<p>
		&copy; 2025 <a href="https://belino.com/">m4xth0r</a>
		&#183;  <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>

</footer>


<a href="#" class="scroll-up"><svg class="scroll" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="-2.4 -2.4 28.8 28.8"
   stroke-width="0">
   <g id="st-ring" stroke-linecap="round" stroke-linejoin="round" stroke-width=".96">
      <circle cx="12" cy="12" r="10" />
      <path
         d="M15 14a1 1 0 0 1-.71-.29L12 11.41l-2.29 2.3a1 1 0 0 1-1.42-1.42l3-3a1 1 0 0 1 1.42 0l3 3a1 1 0 0 1 0 1.42A1 1 0 0 1 15 14" />
   </g>
   <circle id="st-circle" cx="12" cy="12" r="10" />
   <path id="st-arrow"
      d="M15 14a1 1 0 0 1-.71-.29L12 11.41l-2.29 2.3a1 1 0 0 1-1.42-1.42l3-3a1 1 0 0 1 1.42 0l3 3a1 1 0 0 1 0 1.42A1 1 0 0 1 15 14Z" />
</svg></a>
<noscript>
    <a href="#" class="scroll-up show"><svg class="scroll" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="-2.4 -2.4 28.8 28.8"
   stroke-width="0">
   <g id="st-ring" stroke-linecap="round" stroke-linejoin="round" stroke-width=".96">
      <circle cx="12" cy="12" r="10" />
      <path
         d="M15 14a1 1 0 0 1-.71-.29L12 11.41l-2.29 2.3a1 1 0 0 1-1.42-1.42l3-3a1 1 0 0 1 1.42 0l3 3a1 1 0 0 1 0 1.42A1 1 0 0 1 15 14" />
   </g>
   <circle id="st-circle" cx="12" cy="12" r="10" />
   <path id="st-arrow"
      d="M15 14a1 1 0 0 1-.71-.29L12 11.41l-2.29 2.3a1 1 0 0 1-1.42-1.42l3-3a1 1 0 0 1 1.42 0l3 3a1 1 0 0 1 0 1.42A1 1 0 0 1 15 14Z" />
</svg></a>
</noscript>
<script async src="https://belino.com/js/scrollwatcher.min.11bd2ce6f91dfb64095448b76ac1930124a42dc7133488e6d3d5aae7badaf562.js" integrity="sha256-Eb0s5vkd+2QJVEi3asGTASSkLccTNIjm09Wq57ra9WI=" crossorigin="anonymous"></script>
<script async src="https://belino.com/js/bundle.min.c7c384e4d29d192bbac6811ae4660bb01767194a5bea56baca77e8260f93ea16.js" integrity="sha256-x8OE5NKdGSu6xoEa5GYLsBdnGUpb6la6ynfoJg+T6hY=" crossorigin="anonymous"></script><script async src="https://belino.com/js/link-share.min.24409a4f6e5537d70ffc55ec8f9192208d718678cb8638585342423020b37f39.js" integrity="sha256-JECaT25VN9cP/FXsj5GSII1xhnjLhjhYU0JCMCCzfzk=" crossorigin="anonymous"></script><nav class="LangNav" style="text-align: center;">
        
            <a href="https://belino.com/en/posts/rogueap/">English</a>
            
             üá∫üá∏ 
        
    </nav>
</body>

</html>
